<!DOCTYPE html>
<html>
<head>
    <title>æˆ‘çš„å–®æ©Ÿå°ˆæ¡ˆè¿½è¹¤å™¨</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: auto; }
        h2 { border-bottom: 2px solid #ccc; padding-bottom: 10px; }
        input[type="text"], input[type="date"], button { padding: 10px; margin-bottom: 10px; width: 100%; box-sizing: border-box; }
        button { background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { opacity: 0.8; }
        .project-item { border: 1px solid #eee; margin-bottom: 15px; padding: 15px; border-radius: 5px; position: relative; }
        .date-label { display: block; font-size: 0.9em; color: #555; margin-top: 5px; }
        .delete-btn { background-color: #f44336; width: auto; padding: 5px 10px; float: right; }
    </style>
</head>
<body>

    <h1>ğŸ“ æ¥æ¡ˆæ™‚ç¨‹å–®æ©Ÿè¿½è¹¤å™¨</h1>
    <p>æ‰€æœ‰è³‡æ–™æœƒè‡ªå‹•ä¿å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­ï¼Œä¸éœ€ç™»å…¥å¸³è™Ÿã€‚</p>

    <h2>æ–°å¢å°ˆæ¡ˆ</h2>
    <input type="text" id="projectName" placeholder="å°ˆæ¡ˆåç¨± (ä¾‹å¦‚: XXå»£å‘Šæ‹æ”)" required>
    
    <label for="scriptDate">è…³æœ¬æ­»ç·šæ—¥æœŸ:</label>
    <input type="date" id="scriptDate" required>
    
    <label for="shootingDate">æ‹æ”æ—¥æœŸ:</label>
    <input type="date" id="shootingDate" required>
    
    <label for="submissionDate">äº¤ç¨¿æ­»ç·šæ—¥æœŸ:</label>
    <input type="date" id="submissionDate" required>
    
    <button onclick="addProject()">+ åŠ å…¥å°ˆæ¡ˆ</button>

    <h2>å°ˆæ¡ˆåˆ—è¡¨</h2>
    <div id="projectList">
        </div>

    <script>
        // --- JavaScript é‚è¼¯å€å¡Š ---
        const STORAGE_KEY = 'clientProjects';

        function loadProjects() {
            // å¾ç€è¦½å™¨å„²å­˜å€è®€å–è³‡æ–™ï¼Œå¦‚æœæ²’æœ‰å‰‡è¿”å›ç©ºé™£åˆ—
            const json = localStorage.getItem(STORAGE_KEY);
            return json ? JSON.parse(json) : [];
        }

        function saveProjects(projects) {
            // å°‡å°ˆæ¡ˆæ¸…å–®å­˜å›ç€è¦½å™¨
            localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
        }

        function displayProjects() {
            const projects = loadProjects();
            const listDiv = document.getElementById('projectList');
            listDiv.innerHTML = '';

            if (projects.length === 0) {
                listDiv.innerHTML = '<p style="color:gray;">ç›®å‰æ²’æœ‰è¿½è¹¤ä¸­çš„å°ˆæ¡ˆã€‚</p>';
                return;
            }

            // ä¾æ“šäº¤ç¨¿æ­»ç·šæ’åº (æœ€è¿‘çš„æ’åœ¨æœ€å‰é¢)
            projects.sort((a, b) => new Date(a.submissionDate) - new Date(b.submissionDate));

            projects.forEach((project, index) => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'project-item';
                
                // æª¢æŸ¥äº¤ç¨¿æ—¥æœŸæ˜¯å¦å°‘æ–¼ 7 å¤© (ç°¡å–®çš„è­¦ç¤ºè‰²)
                const today = new Date();
                const deadline = new Date(project.submissionDate);
                const diffTime = deadline.getTime() - today.getTime();
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                const deadlineColor = diffDays <= 7 ? 'style="color:red; font-weight: bold;"' : '';


                itemDiv.innerHTML = `
                    <h3>${project.name}</h3>
                    <button class="delete-btn" onclick="deleteProject(${index})">åˆªé™¤</button>
                    <span class="date-label">è…³æœ¬æ­»ç·šï¼š${project.scriptDate}</span>
                    <span class="date-label">æ‹æ”æ—¥æœŸï¼š${project.shootingDate}</span>
                    <span class="date-label" ${deadlineColor}>äº¤ç¨¿æ­»ç·šï¼š${project.submissionDate} (é‚„å‰© ${diffDays} å¤©)</span>
                `;
                listDiv.appendChild(itemDiv);
            });
        }

        function addProject() {
            const name = document.getElementById('projectName').value;
            const script = document.getElementById('scriptDate').value;
            const shooting = document.getElementById('shootingDate').value;
            const submission = document.getElementById('submissionDate').value;

            if (!name || !script || !shooting || !submission) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½ï¼');
                return;
            }

            const newProject = {
                name: name,
                scriptDate: script,
                shootingDate: shooting,
                submissionDate: submission
            };

            const projects = loadProjects();
            projects.push(newProject);
            saveProjects(projects);

            // æ¸…ç©ºè¼¸å…¥æ¬„ä½
            document.getElementById('projectName').value = '';
            document.getElementById('scriptDate').value = '';
            document.getElementById('shootingDate').value = '';
            document.getElementById('submissionDate').value = '';

            displayProjects();
        }

        function deleteProject(indexToDelete) {
            if (!confirm("ç¢ºå®šè¦åˆªé™¤é€™å€‹å°ˆæ¡ˆå—ï¼Ÿ")) {
                return;
            }
            const projects = loadProjects();
            // å¾é™£åˆ—ä¸­åˆªé™¤æŒ‡å®šç´¢å¼•çš„å°ˆæ¡ˆ
            projects.splice(indexToDelete, 1);
            saveProjects(projects);
            displayProjects();
        }

        // é é¢è¼‰å…¥æ™‚é‹è¡Œä¸€æ¬¡ï¼Œé¡¯ç¤ºç¾æœ‰çš„å°ˆæ¡ˆ
        window.onload = displayProjects;
    </script>

</body>
</html>
